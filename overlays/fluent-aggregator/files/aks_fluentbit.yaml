serviceMonitor:
  enabled: true
  namespace: monitoring
  interval: 10s
  scrapeTimeout: 10s
  jobLabel: fluentbit
  selector:
    release: monitoring-prometheus
prometheusRule:
  enabled: true
  namespace: "monitoring"
  additionalLabels:
    release: prometheus
  rules:
  - alert: NoOutputBytesProcessed
    expr: rate(fluentbit_output_proc_bytes_total[5m]) == 0
    annotations:
      message: |
        Fluent Bit instance {{ $labels.instance }}'s output plugin {{ $labels.name }} has not processed any
        bytes for at least 15 minutes.
      summary: No Output Bytes Processed
    for: 15m
    labels:
      severity: critical
dashboards:
  enabled: true
  namespace: "monitoring"
config:
  inputs: |
    [INPUT]
        Name dummy

    [INPUT]
        Name tail
        Path /var/log/nginx/*.log
        Tag kube.*
        Mem_Buf_Limit 5MB
        Skip_Long_Lines On
  outputs: |
    [OUTPUT]
        Name forward
        Match *
        Host fluent-aggregator-fluentd.logging.svc
        Port 24224